{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\n\nconst API_KEY = \"41829655-bf270f19af5dfab9e341d37e3\";\n\nconst cardContainer = document.querySelector(\".card-container\");\nconst searchForm = document.querySelector(\".search-form\");\nconst loader = document.querySelector(\".loader\");\nconst fetchMoreBtn = document.querySelector(\".btn-more-primary\");\n\nsearchForm.addEventListener(\"submit\", handleSearch);\nfetchMoreBtn.addEventListener(\"click\", fetchMorePhotos);\n\nconst lightbox = new SimpleLightbox(\".card-container a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nlet page = 1;\nlet limit = 40;\nlet totalPages = 1;\nlet lastQuery = \"\";\nlet endMessage = null;\n\nfetchMoreBtn.style.display = \"none\";\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  const form = event.currentTarget;\n  const query = form.elements.query.value;\n\n  if (!query.trim()) {\n    return;\n  }\n\n  clearGallery();\n  showLoader();\n\n  try {\n    const data = await fetchPhotos(query, page, limit);\n    renderPhotos(data);\n\n    totalPages = Math.ceil(100 / limit);\n    page = 1;\n    lastQuery = query;\n\n    if (data.hits.length === 0) {\n      fetchMoreBtn.style.display = \"none\";\n      \n    } else {\n      fetchMoreBtn.style.display = \"block\";\n    }\n  } catch (error) {\n    onFetchError(error);\n  } finally {\n    form.reset();\n    hideLoader();\n  }\n}\n\nasync function fetchMorePhotos() {\n  \n  if (page > totalPages) {\n    return;\n  }\n  showLoader();\n  try {\n    const data = await fetchPhotos(lastQuery, page, limit);\n    renderPhotos(data);\n    page += 1;\n\n    if (page > totalPages) {\n      fetchMoreBtn.style.display = \"none\";\n      showEndMessage();\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function fetchPhotos(query, page, limit) {\n  const url = `https://pixabay.com/api/?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${limit}`;\n\n  try {\n    const response = await axios.get(url);\n    return response.data;\n  } catch (error) {\n    throw new Error('Failed to fetch photos'); \n  }\n}\n\nfunction renderPhotos(data) {\n  const photos = data.hits || [];\n\n  if (photos.length === 0) {\n    onFetchError(new Error(\"No images found.\"));\n    return;\n  }\n\n  const markup = photos\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `\n        <li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\" class=\"gallery-link\">\n                <img \n                class=\"gallery-image\" \n                src=\"${webformatURL}\" \n                alt=\"${tags}\"\n                width=\"360\" \n                height=\"200\"\n                />\n                <ul class=\"gallery-item-description\">\n                    <li class=\"comments\" >Likes: ${likes}</li>\n                    <li class=\"comments\" >Views: ${views}</li>\n                    <li class=\"comments\" >Downloads: ${downloads}</li>\n                    <li class=\"comments\" >Comments: ${comments}</li>\n                </ul>\n            </a>\n        </li>\n        `\n    )\n    .join(\"\");\n\n  cardContainer.innerHTML += markup;\n  lightbox.refresh();\n}\n\nfunction onFetchError(error) {\n\n  iziToast.show({\n    position: 'topRight',\n    messageColor: '#FFF',\n    messageSize: \"16px\",\n    close: false,\n    backgroundColor: '#EF4040',\n    message: \"Sorry, there are no images matching your search query. Please try again!\",\n  });\n  \n}\n\nfunction clearGallery() {\n  cardContainer.innerHTML = \"\";\n}\n\nfunction showLoader() {\n  loader.classList.add(\"visible\");\n}\n\nfunction hideLoader() {\n  loader.classList.remove(\"visible\");\n}\n\nfunction showEndMessage() {\n    endMessage = iziToast.error({\n      position: \"topRight\",\n      message: \"We're sorry, but you've reached the end of search results.\"\n    });\n  \n}\n"],"names":["API_KEY","cardContainer","searchForm","loader","fetchMoreBtn","handleSearch","fetchMorePhotos","lightbox","SimpleLightbox","page","limit","totalPages","lastQuery","event","form","query","clearGallery","showLoader","data","fetchPhotos","renderPhotos","onFetchError","hideLoader","showEndMessage","error","url","axios","photos","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast"],"mappings":"owBAMA,MAAMA,EAAU,qCAEVC,EAAgB,SAAS,cAAc,iBAAiB,EACxDC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAe,SAAS,cAAc,mBAAmB,EAE/DF,EAAW,iBAAiB,SAAUG,CAAY,EAClDD,EAAa,iBAAiB,QAASE,CAAe,EAEtD,MAAMC,EAAW,IAAIC,EAAe,oBAAqB,CACvD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,IAAIC,EAAO,EACPC,EAAQ,GACRC,EAAa,EACbC,EAAY,GAGhBR,EAAa,MAAM,QAAU,OAE7B,eAAeC,EAAaQ,EAAO,CACjCA,EAAM,eAAc,EAEpB,MAAMC,EAAOD,EAAM,cACbE,EAAQD,EAAK,SAAS,MAAM,MAElC,GAAKC,EAAM,OAIX,CAAAC,IACAC,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAYJ,EAAON,EAAMC,CAAK,EACjDU,EAAaF,CAAI,EAEjBP,EAAa,KAAK,KAAK,IAAMD,CAAK,EAClCD,EAAO,EACPG,EAAYG,EAERG,EAAK,KAAK,SAAW,EACvBd,EAAa,MAAM,QAAU,OAG7BA,EAAa,MAAM,QAAU,OAEhC,MAAC,CACAiB,EAAkB,CACtB,QAAY,CACRP,EAAK,MAAK,EACVQ,GACD,EACH,CAEA,eAAehB,GAAkB,CAE/B,GAAI,EAAAG,EAAOE,GAGX,CAAAM,IACA,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAYP,EAAWH,EAAMC,CAAK,EACrDU,EAAaF,CAAI,EACjBT,GAAQ,EAEJA,EAAOE,IACTP,EAAa,MAAM,QAAU,OAC7BmB,IAEH,OAAQC,EAAP,CACA,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRF,GACD,EACH,CAEA,eAAeH,EAAYJ,EAAON,EAAMC,EAAO,CAC7C,MAAMe,EAAM,gCAAgCzB,OAAae,kEAAsEN,cAAiBC,IAEhJ,GAAI,CAEF,OADiB,MAAMgB,EAAM,IAAID,CAAG,GACpB,IACjB,MAAC,CACA,MAAM,IAAI,MAAM,wBAAwB,CACzC,CACH,CAEA,SAASL,EAAaF,EAAM,CAC1B,MAAMS,EAAST,EAAK,MAAQ,GAE5B,GAAIS,EAAO,SAAW,EAAG,CACvBN,EAA0C,EAC1C,MACD,CAED,MAAMO,EAASD,EACZ,IACC,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IACvE;AAAA;AAAA,uBAEeL;AAAA;AAAA;AAAA,uBAGAD;AAAA,uBACAE;AAAA;AAAA;AAAA;AAAA;AAAA,mDAK4BC;AAAA,mDACAC;AAAA,uDACIE;AAAA,sDACDD;AAAA;AAAA;AAAA;AAAA,SAKjD,EACA,KAAK,EAAE,EAEVjC,EAAc,WAAa2B,EAC3BrB,EAAS,QAAO,CAClB,CAEA,SAASc,EAAaG,EAAO,CAE3BY,EAAS,KAAK,CACZ,SAAU,WACV,aAAc,OACd,YAAa,OACb,MAAO,GACP,gBAAiB,UACjB,QAAS,0EACb,CAAG,CAEH,CAEA,SAASpB,GAAe,CACtBf,EAAc,UAAY,EAC5B,CAEA,SAASgB,GAAa,CACpBd,EAAO,UAAU,IAAI,SAAS,CAChC,CAEA,SAASmB,GAAa,CACpBnB,EAAO,UAAU,OAAO,SAAS,CACnC,CAEA,SAASoB,GAAiB,CACTa,EAAS,MAAM,CAC1B,SAAU,WACV,QAAS,4DACf,CAAK,CAEL"}